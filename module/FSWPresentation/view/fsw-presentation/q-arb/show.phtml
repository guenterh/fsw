

<?php

    $qArbeiten = $this->qArbeiten;
    $all = $this->all;
    $baseURL = $this->$baseURL;
    $params = $this->params;

?>

<?php $params = $this->sortSwitcher($params) ?>

<?php if (array_key_exists('sort', $params)): ?>

    <?php if (strcmp($params['sort'],'name') == 0): ?>
        <?php $sorttext = 'alphabetische Sortierung' ?>
    <?php else: ?>
        <?php $sorttext = 'chronologische Sortierung' ?>
    <?php endif; ?>


    <a class="internal"  href="<?php echo $this->url('presentation/default', array('controller' => 'qarb','action' => 'show'), array('query' => $params)); ?>"><?php echo $sorttext; ?></a>
    <p>&nbsp;</p>

<?php endif; ?>

<ul class="type1">

    <?php foreach($qArbeiten as $qArbeit): ?>
    <li>
        <!-- noch  zu machen: meherere Autoren-->

            <p class="noMarginBottom"><b>
                    <?php if ($qArbeit->isSetProfilURL()): ?>

                        <a class="internal" href="<?php echo $qArbeit->getProfilURL();?>" target="_blank"><?php echo $qArbeit->getPersName() . ',&nbsp;' . $qArbeit->getPersVorname();?></a>
                     <?php else: ?>
                        <?php echo $qArbeit->getPersName() . ',&nbsp;' . $qArbeit->getPersVorname();?>
                    <?php endif; ?>


                </b>
                <br />

                <?php echo $qArbeit->getQarbArbTitel(); ?>


                <?php
                $showDatum = false;
                foreach ($params['status'] as $status) {
                    if (strcmp($status,'abgeschlossen') == 0) {
                        $showDatum = true;
                        break;
                    }
                }
                ?>

                <?php if ($showDatum): ?>
                    &nbsp; Abschluss: <?php echo $qArbeit->getQarbArbAbschlussjahr(); ?>
                <?php endif; ?>

                <?php if ($all): ?>

                    &nbsp; (Ref.:&nbsp;<?php if ($qArbeit->getBetreuer1Info()->isSetProfilURL()): ?>
                        <a class="internal" href="<?php echo trim($qArbeit->getBetreuer1Info()->getProfilURL());?>" target="_blank">
                            <?php echo trim($qArbeit->getBetreuer1Info()->getNachName()) . '&nbsp;' . trim($qArbeit->getBetreuer1Info()->getVorName());?>)
                        </a>
                    <?php else: ?>
                        <?php echo trim($qArbeit->getBetreuer1Info()->getNachName()) . '&nbsp;' . trim($qArbeit->getBetreuer1Info()->getVorName());?>)
                    <?php endif; ?>

                    <?php if ($qArbeit->isSetBetreuer2Info()): ?>
                        &nbsp; (Zweitref.:&nbsp;<?php if ($qArbeit->getBetreuer2Info()->isSetProfilURL()): ?>
                            <a class="internal" href="<?php echo $qArbeit->getBetreuer2Info()->getProfilURL();?>" target="_blank">
                                <?php echo $qArbeit->getBetreuer2Info()->getNachName() . '&nbsp;' . $qArbeit->getBetreuer2Info()->getVorName();?>)
                            </a>
                        <?php else: ?>
                            <?php echo $qArbeit->getBetreuer2Info()->getNachName() . '&nbsp;' . $qArbeit->getBetreuer2Info()->getVorName();?>)
                        <?php endif; ?>
                    <?php endif; ?>
                <?php endif; ?>
            </p>


        <?php if ($qArbeit->isSetAbstract()): ?>
            <div>
                <a class="internal abstractCaption" href="#">mehr</a>
                <br/>
                <div class="abstractText">
                    <?php echo $qArbeit->getQarbArbAbstract(); ?> &nbsp;
                </div>
            </div>

        <?php endif; ?>

        <!--
        wenn abgeschlossene Diss und im Feld $qArbeit->getQarbArbURL() etwas vorhanden ist sollte als Linktext
        "Onlinepublikation" erscheinen
        -->
        <?php if ($qArbeit->isSetQarbArbURL()): ?>
            <div><a class="www" href="<?php echo $qArbeit->getQarbArbURL();?>" target="_blank">Archivexemplar der Zentralbibliothek ZÃ¼rich</a></div>
        <?php endif; ?>

        <?php if ($qArbeit->isSetQarbArbISBN()): ?>
            <div><a class="www" href="<?php echo "https://www.swissbib.ch/Search/Results?lookfor=" . $qArbeit->getQarbArbISBN();?>" target="_blank">Publikation</a></div>
        <?php endif; ?>

    </li>


    <?php endforeach; ?>
</ul>

